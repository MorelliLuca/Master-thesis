\chapter{GW in the post-inflationary universe}
\label{chap:GW}
In this chapter we will study the evolution of gravitational waves in the post-inflationary universe. Understanding the evolution and how this can magnify of reduce any cosmological signal, is fundamental for observations. To begin with, we will describe free propagation of gravitational waves in the different epochs of the universe to then introduce their possible interactions. 

\section{Free gravitational waves in FRW universe}
\label{sec:free_GW}
To study the propagation of gravitational waves in the FRW universe we must start from the Hilbert-Einstein action: at second order in tensor metric perturbations $h_{ij}$ it reads
\begin{equation*}
    \mathcal{S} [h_{ij}]=\frac{1}{64\pi G}\int d^4xa^2\Big[(h'_{ij})^2-(\partial_k h_{ij})^2\Big].
\end{equation*}
Since the tensor $h_{ij}$ is a transverse traceless symmetric 3-tensor its dynamical degrees of freedom are reduced: to better see this let's move to Fourier space. A transverse symmetric 3-tensor must now satisfy the condition $k^i\tilde h_{ij}=k^i \tilde h_{ji}=0$ which, by rotating the axis such that $\mathbf k\parallel\versor z$, reads $\tilde{h}_{i1}=\tilde{h}_{1i}=0$. Further imposing the traceless condition we have $\tilde{h}_{11}=-\tilde h_{22}$, since by the transversality condition $\tilde{h}_{33}=0$. Lastly, being a symmetric tensor we have $\tilde{h}_{12}=\tilde{h}_{21}$. This showed that gravitational waves posses only 2 dynamical degrees of freedom, which we call \emph{polarizations}: indeed, defining $\tilde{h}_+\defeq\tilde{h}_{12}$ and $ \tilde{h}_\times\defeq\tilde{h}_{11}$
\begin{equation}
    \tilde{h}_{ij}=\tilde{h}_+\boldsymbol{\epsilon}_{ij}^++\tilde{h}_{\times}\boldsymbol{\epsilon}_{ij}^\times=
    \begin{pmatrix}
\tilde h_+ & \tilde h_\times & 0  \\ 
\tilde h_\times & -\tilde h_+ & 0  \\
0&0&0
    \end{pmatrix}\qquad\text{with }\boldsymbol{\epsilon}^\lambda_{ij}\boldsymbol{\epsilon}^{\lambda}_{ij}=1.
    \label{eq:GW-polarizations}
\end{equation}
This decomposition allows us to rewrite the action as the sum of the actions of each polarization, which turns out to be the same:
\begin{equation*}
    \mathcal{S} [h_{ij}]=\frac{1}{64\pi G}\sum_{\lambda=+,\times}\int d^4xa^2\Big[(h'_{\lambda})^2-(\partial_k h_{\lambda})^2\Big],
\end{equation*}
Varying this action the equation of motion for both polarizations reads
\begin{equation}
    h''+2\frac{a'}{a}h'-\boldsymbol{\nabla}^2h=0,\label{eq:EOM_GW_FREE}
\end{equation} 
where we suppressed the label $\lambda$ since the dynamics is identical for both polarizations. To solve the above we shall choose a background on which the gravitational wave propagates: we will consider \emph{radiation dominated} and \emph{matter dominated}  backgrounds. In general, the Friedmann equation gives $a(\tau)\propto\tau^{2/(3\omega+1)}$, which results in two different equations of motion: in Fourier space they read
\begin{align}
    \tilde h_k''+2\frac{\beta}{\tau}\tilde h_k'+\boldsymbol{k}^2\tilde h_k=0,\qquad \beta=\frac{2}{(3\omega+1)}=\begin{cases}
        1\ \text{radiation dominated,}\\
        2\ \text{matter dominated.}
    \end{cases}\label{eq:GW_Fourier}
\end{align}
We recognize that the above equation can be turned in the Bessel equation by defining the variable $x\defeq k\tau$ and matching $J_\nu=x^\alpha\tilde h_k$
\begin{align*}
    0&=\frac{d^2\tilde h_k}{dx^2}+2\frac{\beta}{x}\frac{d\tilde h_k}{dx}+\tilde h_k=\frac{d^2}{dx^2}J_\nu x^\alpha+2\frac{\beta}{x}\frac{d}{dx}J_\nu x^\alpha+J_\nu x^\alpha\\ &=x^\alpha\bigg[\frac{d^2J_\nu}{dx^2}+\frac{2\alpha}{x}\frac{dJ_\nu}{dx}+\alpha\frac{\alpha-1}{x^2}J_\nu+2\frac{\beta}{x}\bigg(\frac{dJ_\nu}{dx}+\frac{\alpha}{x}J_\nu\bigg)+J_\nu\bigg]\\
    &=x^\alpha\bigg[\frac{d^2J_\nu}{dx^2}+2\frac{\alpha+\beta}{x}\frac{dJ_\nu}{dx}+\bigg(1+\alpha\frac{\alpha-1}{x^2}+\frac{2\alpha\beta}{x^2}\bigg)J_\nu\bigg]
\end{align*}
then by fixing $\alpha$ such that $\alpha+\beta=1/2$ 
$$\frac{d^2J_\nu}{dx^2}+\frac{1}{x}\frac{dJ_\nu}{dx}+\bigg(1+\frac{(\beta-\frac{1}{2})^2}{x^2}\bigg)J_\nu=\frac{d^2J_\nu}{dx^2}+\frac{1}{x}\frac{dJ_\nu}{dx}+\bigg(1-\frac{\nu^2}{x^2}\bigg)J_\nu=0.$$
The above shows that the solutions to the gravitational wave equation are the Bessel function, of order $\nu=\beta-\tfrac12$ times $(k\tau)^{-\beta+1/2}$,
$$\tilde h_k(\tau)=(k\tau)^{\frac{1}{2}-\beta}\bigg[C_1(\mathbf{k}) J_{\beta-\frac{1}{2}}(k\tau)+C_2(\mathbf{k}) Y_{\beta-\frac{1}{2}}(k\tau)\bigg],$$
where $J_\nu$ and $Y_\nu$ are the \emph{Bessel functions of the first and second kind}, respectively, and $\beta$ depends on the background cosmology. Note that the above solution can be expressed in a nicer form by using the \emph{spherical Bessel functions}, which are defined by $j_\ell(x)=\sqrt{\frac{\pi}{2x}}J_{\ell+\frac{1}{2}},\ y_\ell(x)=\sqrt{\frac{\pi}{2x}}Y_{\ell+\frac{1}{2}}$. Reabsorbing the extra factors and $k^{\beta}$ in the two constants $C_1$ and $C_2$ and recalling that $a\propto\tau^{\beta}$ we have
\begin{equation}
    \label{eq:free_GW_sol}
    \tilde h_k(\tau)=C_1(\mathbf{k})\tau\frac{j_{\beta-1}(k\tau)}{a(\tau)}+C_2(\mathbf{k})\tau\frac{y_{\beta-1}(k\tau)}{a(\tau)}.
\end{equation}
\begin{figure}
    \centering
\begin{tikzpicture}
  \begin{axis}[
      grid=major,
      xlabel={$k\tau$},
      ylabel={$h_k(\tau)$},
      width=12cm, height=7cm,
      xmin=0, xmax=30
  ]
    % Load and plot from the external file
    \addplot [thick, dashed, smooth] table {CMB/tensor_rad.dat};
    \addlegendentry{Rad. Dom.}
    \addplot [thick, smooth] table {CMB/tensor_mat.dat};
    \addlegendentry{Mat. Dom.}
  \end{axis}
\end{tikzpicture}
\caption{Comparison of the evolution of the amplitude of primordial gravitational waves in radiation domination and in matter domination. We used the condition $C_2=0$ and $C_1=1$. }
\label{fig:h_m/r}
\end{figure}
Note that the above solution holds also during slow-roll inflation, when a simple calculation gives $\beta\approx-1$. Lastly, let us appreciate that super Hubble horizon and sub Hubble horizon regimes we recover the behaviors which we already discovered studying inflation: from equation \eqref{eq:EOM_GW_FREE}, in the limit $k^2\gg a'/a=a H$ oscillating modes are displayed at sub Hubble horizon scales while for $k^2\ll\ a'/a=a H$ the solution reads:
$$\tilde h_k(\tau)=C_1(\mathbf k)+C_2(\mathbf k)\int\frac{d\tau}{a^2},$$ which is a combination of a constant mode and a mode that decays as the universe expands. The superhorizon constant solution implies that the condition $C_2(\mathbf k)=0$ must be imposed since $y_n(x)$ diverges for $x\to 0$, while $j_n(x)$ is regular (see Appendix \ref{app:sph_bessel}), in this way a matching with the inflationary solution can be obtained.
\section{Interacting GW}
The previous section was devoted to study the evolution of tensor perturbations, namely primordial gravitational waves, in the free case, when no matter perturbations are coupled to these modes.
In general, perturbing the Einstein field equations with tensor perturbations, results in the following
$$\delta G_{\mu\nu}=8\pi G\delta T_{\mu\nu}\quad \Rightarrow\qquad h''_{ij}+2\frac{a'}{a}h'_{ij}-\boldsymbol{\nabla}^2 h_{ij}=16\pi G a^2\delta T_{ij}^{TT},$$
where $\delta T_{ij}^{TT}$ must be the traceless transverse perturbation of the spatial part of the energy-momentum tensor of the cosmic fluid. Indeed, any other component of $\delta T_{ij}$ is orthogonal to gravitational waves and cannot be coupled to them. In Section \ref{sec:perturbations} we introduced the \emph{anisotropic stress} $\pi_{ij}$ exactly as the transverse traceless perturbation of the energy-momentum tensor, we conclude that any anisotropic stress is coupled to gravitational waves:
\begin{equation}
    h''_{ij}+2\frac{a'}{a}h'_{ij}-\boldsymbol{\nabla}^2 h_{ij}=16\pi G a^2\pi_{ij}.\label{eq:GW_EOM_stress}
\end{equation}
In the next section we will study three different sources of anisotropic stress that can influence the evolution of primordial gravitational waves.
\subsection{Neutrino damping}
\label{sec:neutrino_damping}
 Weinberg \cite{Weinberg_nu_dump} showed that free streaming neutrinos, namely neutrinos that decoupled from the plasma (Section \ref{sec:decoupling}) and move freely without being scattered, can source anisotropic stress that then couples with the gravitational waves reducing their amplitudes after having reentered the Hubble radius. In this section we will illustrate this behavior.

To obtain the anisotropic stress related to neutrinos we shall understand their behavior in the early universe: as we know from Section \ref{sec:BoltzmannEquation}, this is described by the \emph{Boltzmann equation}. Describing decoupled neutrinos the collision term must be set to zero, hence the Boltzmann equation will be just a conservation equation. Following the calculations carried out by Weinberg, we will not use the local momentum $\mathbf{p}$ to write the Boltzmann equation. Instead, the comoving momentum $\mathbf{P}$ allows us to make more explicit which term can depend on the metric and source anisotropic stresses. By the chain rule, the Liouville operator can be expressed as
\begin{align*}
    \hat L[f]&=\frac{df}{dt}= \frac{\partial f}{\partial t}+\frac{\partial f}{\partial x^i}\frac{dx^i}{dt}+\frac{\partial f}{\partial P_i}\frac{dP_i}{dt},
\end{align*}
where we can evaluate all the remaining total derivatives with respect to time from the relativistic equations of motion:
$$\frac{dx^i}{dt}=\frac{dx^i/d\lambda}{dx^0/d\lambda}=\frac{P^i}{P^0},\qquad \frac{dP^i}{d\lambda}=\frac{dP^i}{dt}P^0=-\Gamma^i_{\mu\nu} P^\mu P^\nu.$$
A simple calculation yields
\begin{align*}
        \frac{dP_i}{dt}=&\frac{d}{dt}g_{ij}P^j=g_{ij,0}P^j+h_{ij,k}P^iP^k+g_{ij}\frac{dP^j}{dt}=g_{ij,0}P^j+g_{ij,k}P^jP^k-\Gamma^{i}_{\mu\nu}\frac{P^\mu P^\nu}{P^0}\\
        &=g_{ij,0}P^j+g_{ij,k}P^jP^k-2\frac{1}{2}g^{ik}g_{jk,0}P^j-\frac{1}{2}g^{ih}(g_{hk,j}+g_{hj,k}-g_{jk,h})\frac{P^kP^j}{P^0}\\
        &=\frac{1}{2}g_{jk,i}\frac{P^kP^j}{P^0}
\end{align*}
In this way the Boltzmann equation reads
\begin{equation}
    \frac{\partial f}{\partial t}+\frac{\partial f}{\partial x^i}\frac{P^i}{P^0}+\frac{\partial f}{\partial P_i}\frac{P^jP^k}{2P^0}g_{jk,i}=0. \label{eq:Boltzmann_neutrinos}
\end{equation}
We will now assume that initially at some time $t_1$, just after decoupling from the plasma, neutrinos, that were previously in equilibrium with the plasma, are described by a \emph{Fermi-Dirac} distribution with negligible chemical potential:
$$f(\mathbf{x},\mathbf{P},t_1)\defeq\bar f(\mathbf{x},\mathbf{P})=\bigg[\exp\bigg(\sqrt{g^{ij}(\mathbf x,t_1)P_iP_j}/k_B T_1\bigg)+1\bigg]^{-1},$$
where $T_1$ is the temperature of the plasma at $t_1$ and $k_B$ is the Boltzmann constant. In the absence of perturbations the Boltzmann equation would maintain the above solution as time evolves. However, introducing metric perturbations we now have to allow for perturbations $\delta f$ of the phase space distribution to arise with the condition $\delta f(\mathbf x,\mathbf p, t_1)=0$, so that overall we find
$$f(x,\mathbf P)=\bigg[\exp\bigg(\sqrt{g^{ij}(\mathbf x,t_1)P_iP_j}/k_B T_1\bigg)+1\bigg]^{-1}+\delta f(\mathbf{x},\mathbf{P},t).$$
By plugging the above in the Boltzmann equation \eqref{eq:Boltzmann_neutrinos} and keeping only up to first order terms, the equation of motion for the perturbations $\delta f$ is obtained:
\begin{align*}
   0&=\frac{\partial \delta f}{\partial t}+\frac{\partial \delta f}{\partial x^i}\frac{P^i}{P^0}+\frac{P^i}{P^0}\frac{\partial }{\partial x^i}\frac{1}{e^{\sqrt{P_iP^j}/k_BT_1}+1}+\frac{P^jP^k}{2P^0}g_{jk,i}\frac{\partial }{\partial P_i}\frac{1}{e^{\sqrt{P_iP^j}/k_BT_1}+1}\\&= \frac{\partial \delta f}{\partial t}+\frac{\partial \delta f}{\partial x^i}\frac{\hat P^i}{a}+\frac{\hat P^k}{a}\bar f'(P)\frac{P_iP_j}{2P^0}\tensor{g}{^i^j_,_k}(\mathbf{x},t_1)+\bar f'(P)P^i\frac{P^jP^k}{2P^0}g_{jk,i}(\mathbf x, t) \\&= \frac{\partial \delta f}{\partial t}+\frac{\partial \delta f}{\partial x^i}\frac{\hat P^i}{a}-\frac{P}{2a}\bar f'(P)\hat P_k\hat P_i\hat P_j\tensor{h}{_i_j_,_k}(\mathbf{x},t_1)+\frac{P}{2a}\bar f'(P)P_k\hat P_j\hat P_ih_{ji,k}(\mathbf x, t)\\
   &\Longrightarrow\qquad \boxed{\frac{\partial \delta f}{\partial t}+\frac{\partial \delta f}{\partial x^i}\frac{\hat P^i}{a}=\frac{P}{2a}\bar f'(P)\hat P_k\hat P_i\hat P_j\big[\tensor{h}{_i_j}(\mathbf{x},t_1)-h_{ij}(\mathbf x, t)\big]_{,k}},
\end{align*}
where the prime indicates derivatives with respect to the argument of the function and $\hat P^i\defeq P^i/P$ with $P\defeq{\sqrt{P_iP_j\delta^{ij}}}=a P^0$. This differential equation can be integrated quite easily if we assume that the $\mathbf x$ dependence of $h_{ij}$ and $\delta f$ is solely due to a factor $e^{i\mathbf{k\cdot x}}$ and by defining a new variable $u= k\int_{t_1}^{t}dt'/a(t')$: in this way we have
$$\frac{a}{k}\frac{\partial \delta f}{\partial t}+i\delta f \mathbf{\hat P\cdot\hat k}=\frac{\partial}{\partial u}\bigg(\delta f e^{i\mathbf{\hat P\cdot\hat k}u}\bigg)=i\frac{P}{2}\bar f'(P)\mathbf{\hat P\cdot\hat k}\ \hat P_i\hat P_j\big[\tensor{h}{_i_j}(t_1)-h_{ij}( t)\big]$$
which upon integration, with the initial condition $\delta f(t=t_1)=0$, gives
\begin{equation}
    \delta f(u,\mathbf P) = \frac{i}{2}\bar f'(P)\mathbf{\hat P\cdot\hat k}\hat P_i\hat P_j\int_{0}^{u}du'e^{i\mathbf{\hat P\cdot\hat k}(u'-u)}\big(\tensor{h}{_i_j}(0)-h_{ij}(u')\big).
\end{equation}
We now proceed to compute the anisotropic stress tensor $\pi_{ij}$, which accordingly to our definition in Section \ref{sec:BoltzmannEquation} corresponds to the transverse traceless spatial part of the energy-momentum tensor, that for a given phase space distribution reads
\begin{align*}
    \tensor{T}{^i_j}=\frac{1}{\sqrt{- g}}\int dP_1dP_2dP_3\ f(\mathbf x,\mathbf p,t)\frac{P^iP_j}{P^0}.
\end{align*}
In the above equation three first order terms are produced: by the perturbation $\delta f$ and by the momenta $P^i$ and $P^0$ through the metric ($P^i=g^{ij}P_j$ and $P^0=\sqrt{g^ijP_iP_j}$). Combining these contributions together Weinberg \cite{Weinberg_nu_dump} shows that the anisotropic stress reads
\begin{equation}
    \pi_{ij}=-4\bar\rho_\nu(u)\int_0^u dU\ K(u-U)h'_{ij}(U),\quad \text{where}\quad K(s)\defeq\frac{1}{16}\int_{-1}^{+1}dx(1-x^2)^2e^{ixs},\label{eq:pi_ij_neutrinos}
\end{equation}
and again the prime indicates derivatives with respect to the argument of the function while $\bar\rho_\nu$ is the background energy density of neutrinos. Lastly, solving the above kernel integral yields
\begin{equation*}
    K(s)=-\frac{\sin s}{s^3}-3\frac{\cos s}{s^4}+3\frac{\sin s}{s^5}.
\end{equation*}

The result \eqref{eq:pi_ij_neutrinos} can be plugged back in the equation of motion of gravitational waves \eqref{eq:GW_EOM_stress} to obtain an integro-differential equation for $h_{ij}$: 
\begin{align}
    h''_{ij}(u)+2\frac{a'}{a}h'_{ij}(u)+ h_{ij}(u)&=-\frac{64\pi G}{k^2} a^2\bar\rho_\nu(u)\int_0^u dU\ K(u-U)h'_{ij}(U)\nonumber\\
    &=-24f_\nu(u)\bigg(\frac{a'}{a}\bigg)^2\int_0^u dU\ K(u-U)h'_{ij}(U),\label{eq:GW_EOM_neutrinos}
\end{align}
where we assumed again $h_{ij}\propto e^{i\mathbf{k\cdot x}}$, then we changed the variable in equation \eqref{eq:GW_EOM_stress} to $u$ and in the second line we used the Friedmann equation to refactor the energy density of neutrinos into $f_\nu= \bar\rho_\nu/\bar\rho$. Lastly, as we have done in the previous sections we can decompose the tensor modes in their two polarizations, which both satisfy the above. 

Solutions for the equation we found can be approximated in the sub Hubble horizon limit during radiation domination ($a\propto\tau\propto u$), long after the decoupling of neutrinos so that $t_1\approx 0$. Considering three neutrino flavors, then $f_\nu$ takes the constant value of $0.40523$ and overall we get for each polarization
$$ h''(u)+\frac{2}{u}h'(u)+h(u)=-\frac{24f_\nu}{u^2}\int_{0}^{u}dU\ K(u-U)h'(U).$$
The factor $u^{-2}$, in the right-hand side, suppresses the effects of the anisotropic stress inside the Hubble horizon ($u=k\tau$) were the free solution \eqref{eq:EOM_GW_FREE} is recovered
$$h(u)\xrightarrow{u\to 0} \frac{A\sin(u+\delta)}{u},$$
with $A$ and $\delta$ are constants that must be computed numerically. Dicus and Repko \cite{Dicus_Repko} integrated equation \eqref{eq:GW_EOM_neutrinos} numerically expanding the solutions on the spherical Bessel functions $j_n(u)$,
\begin{equation}
    \label{eq:Tmodes_nu_damped}
    h(u)=\sum_{n\text{ even}}^{\infty}a_n j_n(u).
\end{equation}
\begin{figure}
    \centering
\begin{tikzpicture}
  \begin{axis}[
      grid=major,
      xlabel={$k\tau$},
      ylabel={$h_k(\tau)$},
      width=12cm, height=7cm,
      xmin=0, xmax=30
  ]
    % Load and plot from the external file
    \addplot [thick, dashed, smooth] table {CMB/tensor_rad.dat};
    \addlegendentry{Free-sol.}
    \addplot [thick, smooth] table {CMB/tensor_nu.dat};
    \addlegendentry{$\nu$ damped}
  \end{axis}
\end{tikzpicture}
\caption{Comparison of the evolution of the amplitude of primordial gravitational waves in the radiation dominated universe, both in absence and presence of free-streaming neutrinos. }
\label{fig:h_nu}
\end{figure}
 In their work they have computed the numerical coefficients $a_0=1,\ a_2=0.243807,\ a_4=5.28424\times10^{-2},\ a_6= 6.13545\times10^{-3}.\ a_8=2.07534\times10^{-4},\ a_{10}=6.16273\times10^{-5},\ a_{12}=-4.78885\times10^{-6}$ and with smaller and smaller higher coefficients. 
 Moreover, considering that for $u\to0$ all the even order Bessel functions behave as $(-1)^{n/2}\sin(u)/u$, the factor $A$ can be approximated to be
$$A\approx \sum_{n=0}^{5}(-1)^n a_{2n}\approx 0.80313,$$
which shows that the effect of the anisotropic stress is to reduce the amplitude of horizon crossing tensor perturbations.

\subsection{Photon damping}
\label{sec:photon_damping}
A further interaction that can damp the amplitude of primordial gravitational waves is the interaction with photons. Without going in the details of the calculations that can be found in Section \ref{sec:TensorCoupling}, due to their symmetries primordial gravitational waves are directly coupled to the quadrupole momentum of the photon anisotropies. This happens precisely because projecting the polarizations $\mathbf{e}_{ij}^\lambda$ onto the local 3-momentum yields
$$\mathbf{e}_{ij}^{(\pm)}\hat p^i\hat p^j=\sin^2\theta[\cos^2\phi-\sin^2\phi\pm2i\sin\phi\cos\phi]=\sin^2\theta e^{\pm i2\phi}\propto Y_{2,\pm2}(\theta,\phi),$$
where $Y_{2,\pm2}(\theta,\phi)$ are the spherical harmonics of order $2$ and $m=\pm2$ and $\mathbf{e}_{ij}^{(\pm)}$ is the polarization basis introduced by Hu and White \cite{HuWhite} of equation \eqref{eq:HuWhiteBasis}. Indeed, if we expand the phase space distribution, over an initial Planckian distribution, for small fluctuations in the temperature $\Theta(t,\mathbf x,\mathbf p)$ we obtain a perturbation proportional to $\Theta$ itself (the complete calculation can be found in Section \ref{sec:PertToAnis}):
$$
f(t,\mathbf x,\mathbf p)=\bigg[\exp\bigg\{\frac{p}{k_B\bar T(1+\Theta)}\bigg\}-1\bigg]^{-1}\approx \frac{1}{e^{\frac{p}{k_b\bar T}}-1}-\Theta p\frac{\partial \bar f}{\partial p},
$$ 
where $\bar T$ is the average temperature and $\bar f$ is the Planckian distribution. In Section \ref{sec:perturbations} we introduced the anisotropic stress as the transverse traceless part of the energy-momentum tensor, this means that in Fourier space the same decomposition of the polarizations of gravitational waves \eqref{eq:GW-polarizations} holds:
$$\tilde \pi_{ij}=\tilde\pi^{(+)}\boldsymbol e_{ij}^++\tilde\pi^{(\times)}\boldsymbol e_{ij}^\times=\sqrt{\frac{3}{2}} \big(\tilde\pi^{(+)}\mathbf{e}^{(+)}_{ij}+\tilde\pi^{(-)}\mathbf{e}^{(-)}_{ij}\big).$$
We can obtain the anisotropic stress by projecting the energy-momentum tensor onto the polarization basis
\begin{align*}
    \sqrt{\frac32}\tilde T^{ij}\boldsymbol{e}_{ij}^{(\pm)}&=\sqrt{\frac32}\tilde \pi^{ij}\boldsymbol{e}_{ij}^{(\pm)}=\frac{3}{2}4\tilde\pi^{(\mp)}\\
    &=\frac{g_\text{dof}}{(2\pi)^3}\sqrt{\frac32}\int d^3p \frac{p^ip^j}{p^0}\boldsymbol{e}_{ij}^{(\pm)}f(t,\mathbf k,\mathbf p)\\&=\frac{g_\text{dof}}{(2\pi)^3}\sqrt{\frac32}\int d^3p\ p\ \sin^2(\theta)e^{\pm i2\phi}\bigg(\bar f(t,p)-\tilde\Theta p\frac{\partial\bar f}{\partial p}\bigg),
\end{align*}
where in the first line we used that $\boldsymbol{e}_{ij}^{(\pm)}\boldsymbol{e}_{ij}^{(\pm)}=0$ and $\boldsymbol{e}_{ij}^{(\pm)}\boldsymbol{e}_{ij}^{(\mp)}=4$. At ths stage we can recognize the spherical harmonics $Y_{2,\pm2}(\theta,\phi)=\sqrt{\frac{15}{2\pi}}\ \sin^2\theta e^{\pm i2\phi}$ and that by orthonormality the integral over the solid angle of $\versor p$ vanished when integrating $\bar f(t,p)$, while the remaining term gives the quadrupole momentum of the anisotropies. Indeed, expanding $\tilde \Theta$ and using again orthogonality we find
\begin{align*}
    \tilde{\Theta}(\mathbf{k},\versor p)&=\sum_{\ell,m}(-i)^{\ell}\sqrt{\frac{4\pi}{2\ell+1}}Y_{\ell, m}(\versor p)\tilde\Theta_{\ell}^{(m)}(\mathbf k),\\
    \tilde \pi^{(\mp)}&=-\frac{g_\text{dof}}{6(2\pi)^3}\sqrt{\frac32}\int d^3p\ p^2 \frac{\partial\bar f}{\partial p}\sum_{\ell,m}(-i)^{\ell}\sqrt{\frac{2\pi}{15}}\sqrt{\frac{4\pi}{2\ell+1}}Y_{2,\mp2}^*Y_{\ell m}\tilde\Theta_{\ell}^{(m)}\\
    &=-\frac{g_\text{dof}}{6(2\pi)^3}\int_0^\infty dp\ p^4 \frac{\partial\bar f}{\partial p}(-i)^{2}\frac{2\pi}{5}\tilde\Theta_{2}^{(\mp2)}\\
    &=\tilde\Theta_{2}^{(\mp2)}\frac{2}{15}\frac{g_\text{dof}}{(2\pi)^3}\int_0^\infty dp\ 4\pi p^3 \bar f=\frac{2}{15}\tilde\Theta_2^{(\mp2)}\bar\rho_\gamma,
\end{align*}
where in the last line we integrated by parts and then we recognized the integral which yields the energy density.

One can show that this quadrupole momenta is generated directly by primordial gravitational waves (see Section \ref{sec:Anisotropies_From_Tensor}), hence creating a back reaction effect. Using the Friedmann equation in conformal time, $\mathcal{H}^2=\tfrac{8\pi G}{3}\bar\rho a^2$, and assuming radiation domination, $a\propto \tau$ and $\bar\rho=\bar\rho_\gamma+\bar\rho_\nu$, equation \eqref{eq:GW_EOM_stress}. After having decomposed it in the two polarizations, with our previous result we have:
$$
    \tilde h''_{k}+\frac{2}{\tau}\tilde h'_{k}+\boldsymbol{k}^2 \tilde h_{k}=\frac{8}{5}\mathcal{H}^2\frac{\bar\rho_\gamma}{\bar\rho}\tilde\Theta_2^{(2)},
$$
Note that this reasoning holds for all the components of the plasma: indeed, neutrino damping, described in the previous section, can be studied also with this approach, yielding the same results as before.\\
To conclude, since relevant modes renter the Hubble radius at high redshift, we assume the tight coupling limit, the limit in which photons scatterings are very frequent in the plasma and higher multipoles become negligible. In Section \ref{sec:TightCouplingApproximation} we will show that in this approximation holds $\tilde\Theta^{(2)}_2\approx-\tfrac43\tfrac{\tilde h'}{n_e\sigma_T a}$ ,
where $n_e$ is the electron number density and $\sigma_T$ is the Thomson cross-section. In this way we finally obtain 
$$
    \tilde h''_{k}+\frac{2}{\tau}\tilde h'_{k}+\boldsymbol{k}^2 \tilde h_{k}=-\mathcal{H}^2\frac{32(1-R_\nu)}{15n_e\sigma_T a}\tilde h'_{k}\defeq -\Gamma_\gamma \tilde h'_k,
$$
where we defined $R_\nu\defeq\bar\rho_\nu/(\bar\rho_\gamma+\bar\rho_\nu)$. Note that since $a\times n_e\propto a^{-2}$, as well as $\mathcal{H}$ during radiation domination, overall $\Gamma_\gamma$ is constant. In the sub Hubble horizon limit we can neglect the term $\tfrac2\tau \tilde h'_k$ and the equation of motions turns into a damped harmonic oscillator. This means that in this regime the solution reads 
\begin{equation}
    \tilde h_k(\tau)\approx\tilde h_k^{\text{free}}(\tau)e^{-\frac{\Gamma_\gamma}{2}\tau},
\end{equation} 
which is the free solution damped of an exponential factor. On super-Hubble scales the tensor modes are frozen and the damping can be neglected.
\subsection{Primordial magnetic fields}
\label{sec:primordial_magn}
In this section we will analyze a different interaction that can take place in the early universe and that, instead of damping primordial gravitational waves, can source them. Before the decoupling epoch the electric conductivity of the plasma was very high resulting in the total dissipation of any electric field present in the universe. In these extreme conditions, only stationary magnetic fields could survive and interact with the content of the universe. We will show that these can become a source of anisotropic stress that can source gravitational waves.

Let's start introducing the \emph{electromagnetic tensor} 
$$F_{\mu\nu}= A_{\nu;\mu} -  A_{\mu;\nu}= A_{\nu,\mu} -  A_{\mu,\nu},$$
where $A_\mu$ is the \emph{4-potential} and we turned covariant derivatives into partials since all the Christoffel symbols cancel out.
To obtain the \emph{electric} and \emph{magnetic fields} in a curved spacetime, a specific time direction must be chosen: fixing a time-like vector $u^\mu$ then we define
\begin{equation}
    E_\mu\defeq u^\nu F_{\mu\nu},\qquad B_\mu\defeq \frac{1}{2}\epsilon_{\mu\nu\rho\sigma} u^\nu F^{\rho\sigma},\label{eq:EB_fields}
\end{equation}
where $\epsilon_{\mu\nu\rho\sigma}$ is the Levi-Civita symbol. An important consequence of this definition is that the electric and magnetic fields are purely spatial vectors, as they are orthogonal to $u^\mu$:
$$u^\mu E_\mu=u^\mu u^\nu F_{\mu\nu}=0,\qquad u^\mu B_\mu=\frac{1}{2}\epsilon_{\mu\nu\rho\sigma} u^\mu u^\nu F^{\rho\sigma}=0.$$ Note that in Minkowski spacetime $u^\mu=(1,0,0,0)$, which gives the usual definitions $E_i=F_{i0}$ and $B_i=\epsilon_{ijk}F^{jk}/2$. The same holds in FRW spacetime with cosmic time, however using conformal time an extra factor $a^{-1}$ appears due to the normalization $u^\mu u_\mu=-1$. Furthermore, we should note that, being purely spatial vectors, any non-zero electric or magnetic field will break the isotropy of the background spacetime. For this reason, we will assume that these fields appear only at the perturbative level and do not contribute to the Friedmann equations.\\
At this point, inverting equations \eqref{eq:EB_fields} we can show that the electromagnetic tensor is
\begin{equation}
    F_{\mu\nu}=u_\mu E_\nu - u_\nu E_\mu +\epsilon_{\mu\nu\rho\sigma} B^\rho u^\sigma.
\end{equation}
The equations of motion for the $E_i$ and $B_i$ fields are given by the electromagnetic action
$$\mathcal{S}[A^\mu]=-\int \sqrt{-g}\ d^4x \Bigg[\frac{F^{\mu\nu}F_{\mu\nu}}{16\pi}+A_\mu J^\mu\Bigg]\quad \Rightarrow\quad \tensor{F}{^\mu^\nu_;_\mu}=4\pi J^\nu,$$
where $J^\mu$ is the 4-current. The above must be complemented with the Bianchi identity for $F_{\mu\nu}$, which is given by the definition of the electromagnetic tensor and the Schwarz theorem, 
$$F_{[\mu\nu;\rho]}=0.$$
In the above the squared brackets indicate the sum of all the cyclic permutation of the indexes. For our discussion we can focus only on this last equation: choosing the indexes $ij0$ and assuming that $E_i=0$ we find
$$0=F_{[ij;0]}=F_{ij;0}=(\epsilon_{0ijk}B^k)_{;0}=-3H\epsilon_{0ijk}B^k+\epsilon_{0ijk}B^k_{,0}+\epsilon_{0ijk}B^n\Gamma_{0n}^{k},$$
where we used that the Levi-Civita symbol is proportional to $1/\sqrt{-g}=a^{-3}$. To complete our calculation we can use the Christoffel symbol from the \eqref{eq:RWChristoffel}, which gives
$$0=3H\epsilon_{0ijk}B^k+\epsilon_{0ijk}B^k_{,0}+3H\epsilon_{0ijk}B^k=\epsilon_{0ijk}B^k_{,0},$$
that once contracted with another Levi-Civita symbol yields our final result
\begin{equation}
    0=\dot B^k=\frac{\big(B^k\big)'}{a}=\frac{\big(a^2 B_k\big)'}{a}\qquad\Rightarrow\qquad B_k(\tau,\mathbf{x})=\frac{f(\mathbf{x})}{a^2(\tau)}.
\end{equation}
This shows a really important behavior of primordial magnetic fields: their time evolution is completely captured by a scaling of a factor $a^{-2}$. For this reason it is common to define the \emph{physical magnetic field} $\mathbf B_\text{phy}\defeq a^2 \mathbf B$, which is then time independent. 

At this point, to study the effects of primordial magnetic fields on gravitational waves we should compute the energy-momentum tensor of the electromagnetic field
$$
\tensor{T}{^\mu_\nu}=\frac{1}{4\pi}\bigg(F^{\mu\alpha}F_{\nu\alpha}-\frac{1}{4}\tensor{g}{^\mu_\nu} F^{\alpha\beta}F_{\alpha\beta}\bigg).
$$
In our case of study, a straight forward computation shows that, in the absence of electric fields, the energy-momentum tensor reads
\begin{subequations}
    \begin{align}
    \tensor{T}{_0_0}=&\frac{1}{4\pi}\bigg(\mathbf B^2-\frac{1}{2}\mathbf B^2\bigg)=\frac{1}{8\pi}\mathbf B^2=\frac{1}{8\pi a^4}\mathbf B^2_\text{phy},\label{eq:EM_Tensor_00}\\
    \tensor{T}{_0_i}=&0\label{eq:EM_Tensor_0i},\\
    \tensor{T}{_i_j}=&\frac{1}{4\pi}\bigg(B_iB_j-\frac{1}{2}\tensor{\delta}{_i_j} \mathbf B^2\bigg)=\frac{1}{8\pi a^4}\bigg((B_\text{phy})_i(B_\text{phy})_j-\frac{1}{4}\tensor{\delta}{_i_j} \mathbf B_\text{phy}^2\bigg).\label{eq:EM_Tensor_ij}
\end{align}
\end{subequations}
We immediately recognize in the components \eqref{eq:EM_Tensor_ij} a pressure term plus a contribution that can result in an anisotropic stress: this shows that in the presence of primordial magnetic fields, tensor perturbations will couple to these. Moreover, equation \eqref{eq:EM_Tensor_ij} shows that any anisotropic stress would evolve scaling as $a^{-4}$. 

Decomposing the energy momentum tensor in its traceless transverse part in Fourier space, the equation of motion of gravitational waves reads  
\begin{equation*}
     \tilde h''_{ij}+2\frac{a'}{a}\tilde h'_{ij}+\boldsymbol{k}^2 \tilde h_{ij}=16\pi G a^2\tilde\pi^{(B)}_{ij},
\end{equation*}
where $\tilde\pi^{(B)}_{ij}\propto a^{-4}$ is the anisotropic stress of the magnetic field. This kind of source term, not being determined by the system of equations that describes all the cosmological perturbations, acts on gravitational waves as an external force that can further produce perturbations.\\Decomposing the gravitational wave in its two polarization and considering radiation domination ($a \propto\tau$), we obtain the following differential equation for each polarization
\begin{equation}\label{eq:GW_PMag}
\tilde h_k''+\frac{2}{\tau}\tilde h_k'+\mathbf k^2\tilde h_k=\frac{6}{\tau^2}\frac{\tilde\pi^{(B)}}{\bar \rho_\gamma},
\end{equation}
where we used the Friedmann equation to obtain the time independent ratio $\tilde\pi^{(B)}/\bar\rho_\gamma$. This equation can be integrated numerically but the main effects can be understood by studying the sub and super Hubble horizon limits.\\ At super Hubble scales ($k\ll aH\propto\tau^{-1}$) the term $\mathbf k^2\tilde h_k$ becomes negligible and the expansion of the universe and the interactions with the magnetic fields dominate. Defining $u_k=\tilde h'_k$ equation \eqref{eq:GW_PMag} becomes
$$u'_k+\frac{2}{\tau}u_k=\frac{6}{\tau^2}\frac{\tilde\pi^{(B)}}{\bar\rho_\gamma}.$$
We can now use the usual ansatz $u_k\defeq\exp\big(-2\int d\tau/\tau\big)v_k$, which reduces this differential equation to 
$$v_k'=\frac{6}{\tau^2}\frac{\tilde\pi^{(B)}}{\bar\rho_\gamma}e^{-2\int d\tau/\tau}\quad \Rightarrow\quad u_k(\tau)=6\frac{\tilde\pi^{(B)}}{\bar\rho_\gamma}\frac{1}{\tau}-\frac{C}{\tau^2},$$
where $C$ is the integration constant. Integrating one last time we obtain the final solution 
\begin{equation}
    \tilde h_k=6\frac{\tilde\pi^{(B)}}{\bar\rho_\gamma}\log\tau+\frac{C_1}{\tau} + C_2. \label{eq:SH_PM_PGWs}
\end{equation}
In the end we found that, together with the constant and decaying modes we already obtained in Section \ref{sec:free_GW}, a logarithmically increasing mode is generated. To reconnect this solution to the inflationary initial condition we can impose that at some $\tau_0$ when the magnetic fields are sourced 
$$\tilde h_k(\tau_0)=\tilde h_k^\text{infl},\ \tilde h'_k(\tau_0)=0 \quad \Rightarrow\quad \tilde h_k(\tau) = 6 \frac{\tilde\pi^{(B)}}{\bar\rho_\gamma}\bigg(\log\frac{\tau}{\tau_0}+\frac{\tau_0}{\tau}\bigg)+\tilde h_k^\text{infl}.$$
We should then study the sub horizon regime: in this case the the anisotropic stress will still influence the evolution of primordial gravitational waves. However, at the smallest scales the electromagnetic interactions dissipates the magnetic fields and the usual solutions are recovered. This occurs at the so called \emph{damping scale} $k_D$.\\Overall, we discovered that primordial magnetic fields generates a super horizon growth of the gravitational waves sourced by vacuum fluctuations, then upon reentering the Hubble horizon the tensor perturbations start to oscillate again under the influence of the magnetic fields. At some even smaller scale $k_D$ the magnetic fields dissipates and the usual dynamics is reestablished.  
\begin{figure}
    \centering
    \begin{tikzpicture}
        \begin{axis}[
            width=10cm,
            height=7cm,
            xlabel={$k/k_D$},
            ylabel={$k^3 |\tilde{\pi}^{(B)}(k)|^2/ \mathcal{A_B}^2$ },
            domain=0:2,
            samples=200,
            grid=major,
            thick,
            xmin=0, xmax=2
        ]
        % The formula below is the normalized version:
        % y = k^3 * [8/15 - 7/6*k + 16/15*k^2 - 7/24*k^3 - 13/480*k^5 + 11/1920*k^7]
        \addplot[
            smooth
        ] 
        {x^3 * (8/15 - 7/6*x + 16/15*x^2 - 7/24*x^3 - 13/480*x^5 + 11/1920*x^7)};
        \end{axis}
    \end{tikzpicture}
    \caption{Plot of $k^3 |\tilde{\pi}^{(B)}(k)|^2$ for $n_B=2$ as a function of $k/k_D$. We can appreciate that the anisotropic stress has a peak right after $k_D$, to then vanish for $2k_D$.}
    \label{fig:stress_B}
\end{figure}

In general, primordial magnetic fields are modeled as a stochastic background which statistics is captured by a 2-points correlation function,
\begin{equation}
    \langle B_i(\mathbf{k})B^*_j(\mathbf{k'})\rangle=(2\pi)^3\delta^3(\mathbf{k}-\mathbf{k'})P_{ij}(\mathbf{k})\frac{\mathcal P_B(k)}{2},\label{eq:magnetic_2pt},
\end{equation}
were $\mathcal P_B$ is the power spectrum of the magnetic field and with $P_{ij}\defeq \delta_{ij} - \hat k_i\hat k_j$ is the traceless-transverse projector.  Phenomenologically these power spectra can be characterized by a power law
$$\mathcal{P}_B(k)=\mathcal A_B\bigg(\frac{k}{k_0}\bigg)^{n_B},$$
which then allows for the 2-points correlation functions to be obtained:
$$\big\langle \mathbf B^2(\mathbf{x})\big\rangle=\int \frac{d^3k}{(2\pi)^3}\mathcal A_B\bigg(\frac{k}{k_0}\bigg)^{n_B}=\frac{1}{2\pi^2}\int_0^{k_D}\ k^2\ dk\ \mathcal A_B\bigg(\frac{k}{k_0}\bigg)^{n_B}=\frac{\mathcal{A}_B }{2\pi^2(n_B+3)}\frac{k_D^{n_B+3}}{k_0^{n_B}},$$
where we used the damping scale $k_D$ to regularize the integral. Similarly, the anisotropic stress can be computed from
$$\langle\tilde\pi^{*(B)}_{ij}(k)\tilde\pi^{(B)}_{hk}\rangle=\frac{1}{4}|\tilde \pi^{(B)}(k)|^2\mathcal{M}_{ijkh}(k)\delta(k-k'),\text{ and }\mathcal{M}_{ijkh}(k)\defeq P_{ik}P_{jh}+P_{ih}P_{jk}-P_{ij}P_{hk}.$$

An extensive description of the physics of primordial magnetic fields and their interactions with the CMB anisotropies can be found in \cite{Paoletti_2009}: in this work many 2-points correlation function of the anisotropic stress are computed, we only quote here the result in the case $n_B=2$ (Fig. \ref{fig:stress_B}):
\begin{align*}
    |\tilde \pi^{(B)}(k)|^2\bigg|_{n_B=2}&=\frac{\mathcal{A_B}^2k_D^7}{256\pi^4k_0 ^4}\bigg[\frac{8}{15}-\frac{7}{6}k+\frac{16}{15}k^2-\frac{7}{24}k^3-\frac{13}{480}k^5+\frac{11}{1920}k^7\bigg]\\
    &=\frac{25\big\langle \mathbf B^2(\mathbf{x})\big\rangle^2}{64k_D^3}\bigg[\frac{8}{15}-\frac{7}{6}k+\frac{16}{15}k^2-\frac{7}{24}k^3-\frac{13}{480}k^5+\frac{11}{1920}k^7\bigg].
\end{align*}




